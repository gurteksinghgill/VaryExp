lines(n5$x, n5$Px, type="l", col="pink");
lines(n10$x, n10$Px, type="l", col="yellow");
lines(n15$x, n15$Px, type="l", col="green");
lines(n25$x, n25$Px, type="l", col="red");
#legend
#inset
grid();
n100 <- DTSM(xrange, T = 100000, Psi, a, b, d);
par(mfrow=c(1,1));
plot(n1$x, n1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(n2$x, n2$Px, type="l", col="blue");
lines(n5$x, n5$Px, type="l", col="pink");
lines(n10$x, n10$Px, type="l", col="yellow");
lines(n15$x, n15$Px, type="l", col="green");
lines(n25$x, n25$Px, type="l", col="red");
lines(n100$x, n100$Px, type="l", col="brown");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(k1$x, k1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
#legend
#inset
grid();
100/3.125
par(mfrow=c(1,1));
plot(n1$x, n1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(n2$x, n2$Px, type="l", col="blue");
lines(n5$x, n5$Px, type="l", col="pink");
lines(n10$x, n10$Px, type="l", col="yellow");
lines(n15$x, n15$Px, type="l", col="green");
lines(n25$x, n25$Px, type="l", col="red");
lines(n100$x, n100$Px, type="l", col="brown");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(k1$x, k1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(n1$x, n1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(n2$x, n2$Px, type="l", col="blue");
lines(n5$x, n5$Px, type="l", col="pink");
lines(n10$x, n10$Px, type="l", col="yellow");
lines(n15$x, n15$Px, type="l", col="green");
lines(n25$x, n25$Px, type="l", col="red");
lines(n100$x, n100$Px, type="l", col="brown");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
#legend
#inset
grid();
#The DTSM function implements a discrete time semi-Markov algorthim for calculating CTRW limit distributions
#Inputs are range of x (e.g. [0,1]), time T, Tail function Psi and coefficient functions a, b and d
#Outputs are 4 plots of density and age density (at times 0 and T) and a list containing the (x,y) values of the plot of the density at time = T
DTSM <- function (xrange, T, Psi, a, b, d) {
#Set up grid size and spacing parameters
c <- 100;
chi <- (3.125/c);
tau <- (10/c);
age_max <- round(100/tau + 1)*tau;
xrange <- round(xrange/chi)*chi;
#Set up grid and initial condition
xi0 <- matrix(0,round((xrange[2]-xrange[1])/chi + 1), round(age_max/tau + 1));
xi0[round(0.5*(xrange[2]-xrange[1])/chi + 1), 1] <- 1;
xi <- xi0;
#Evaluate Tail function and one-step survival probabilities at every grid point
TailF <- outer(seq(xrange[1],xrange[2],chi),seq(0,age_max,tau) - tau*d(0,0),Psi)/c;
TailF[TailF > 1] <- 1;
Sprob <- cbind(1, TailF[, seq(2,ncol(TailF),1)]/TailF[, seq(1,ncol(TailF)-1,1)] );
#Iterate master equation on grid
k <- round(T/tau);
chk1 <- sum(xi0);
for (i in 1:k) {
#Evaluate jump probabilities at every spatial grid point + Set boundary condition
Jprob <- rbind(c(0.5, 1 - a(seq(xrange[1]+chi,xrange[2]-chi,chi),i*tau), 0.5),
c(0.5, (a(seq(xrange[1]+chi,xrange[2]-chi,chi),i*tau) + chi*b(seq(xrange[1]+chi,xrange[2]-chi,chi),i*tau))/2, 0),
c(0, (a(seq(xrange[1]+chi,xrange[2]-chi,chi),i*tau) - chi*b(seq(xrange[1]+chi,xrange[2]-chi,chi),i*tau))/2, 0.5) );
#Evaluate survivals, escapes and jumps
S <- xi*Sprob;
E <- rowSums(xi*(1-Sprob));
C_J <- E*Jprob[1,];
R_J <- E*Jprob[2,];
L_J <- E*Jprob[3,];
#Update grid with survivals, escapes and jumps
xi <- cbind( c( C_J[1]+L_J[2], R_J[seq(1,length(R_J)-2,1)]+C_J[seq(2,length(C_J)-1,1)]+L_J[seq(3,length(L_J),1)], R_J[length(R_J)-1]+C_J[length(C_J)] ), S[, seq(1,ncol(S)-2,1)], S[, ncol(S)-1]+S[, ncol(S)] );
}
chk2 <- sum(xi);
#Plot density and age density at time = 0 and T
par(mfrow=c(2,2));
plot(seq(xrange[1],xrange[2],chi),rowSums(xi0),type="l", main = "Density at T = 0", xlab = "x", ylab = "P(x,0)");
grid();
plot(seq(0,age_max,tau),colSums(xi0),type="l", main = "Age Density at T = 0", xlab = "t", ylab = "P(V=t)");
grid();
plot(seq(xrange[1],xrange[2],chi),rowSums(xi)/chi,type="l", main = paste("Density at T = ", T), xlab = "x", ylab = paste("P(x,", T, ")"));
grid();
plot(seq(0,age_max,tau),colSums(xi),type="l", main = paste("Age Density at T = ", T), xlab = "t", ylab = "P(V=t)");
grid();
return(list(x = seq(xrange[1],xrange[2],chi), Px = rowSums(xi)/chi));
}
xrange <- c(-1,1);                                      #range of x = (-xmax, xmax)
alpha <- function(x) {r <- 0.5/(1+exp(-x)) + 0.25; return(r)};   #varying exponent, alpha(-inf) = 0, alpha(+inf) = 1
theta <- function(x) {r <- 1/(1+exp(0.5*x)); return(r)};   #varying exponent, alpha(-inf) = 0, alpha(+inf) = 1
Psi <- function(x,t) {r <- (t^(-alpha(x)) * exp(-t*theta(x)) )/gamma(1-alpha(x)); r[r>1] <- 1; return(r)};           #Tail function of psi measure
a <- function(x,s) {r <- (1)^(-alpha(x)); return(r)};          #a(x,s) diffusivity
b <- function(x,s) {r <- 0; return(r)};                         #b(x,s) drift function
d <- function(x,s) {r <- 0; return(r)};                         #d(x,s) temporal drift function
m025 <- DTSM(xrange, T = 250, Psi, a, b, d);
m050 <- DTSM(xrange, T = 500, Psi, a, b, d);
m075 <- DTSM(xrange, T = 750, Psi, a, b, d);
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
lines(m025$x, m025$Px, type="l", col="red");
lines(m050$x, m050$Px, type="l", col="red");
lines(m075$x, m075$Px, type="l", col="red");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m025$x, m025$Px, type="l", col="red");
lines(m050$x, m050$Px, type="l", col="red");
lines(m075$x, m075$Px, type="l", col="red");
par(mfrow=c(1,1));
lines(m025$x, m025$Px, type="l", col="red");
lines(m075$x, m075$Px, type="l", col="red");
par(mfrow=c(1,1));
plot(m025$x, m025$Px, type="l", col="red");
lines(m050$x, m050$Px, type="l", col="red");
lines(m075$x, m075$Px, type="l", col="red");
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
lines(m075$x, m075$Px, type="l", col="red");
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(n1$x, n1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(n2$x, n2$Px, type="l", col="blue");
lines(n5$x, n5$Px, type="l", col="pink");
lines(n10$x, n10$Px, type="l", col="yellow");
lines(n15$x, n15$Px, type="l", col="green");
lines(n25$x, n25$Px, type="l", col="red");
lines(n100$x, n100$Px, type="l", col="brown");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(k1$x, k1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
#legend
#inset
grid();
xrange <- c(-1,1);                                      #range of x = (-xmax, xmax)
alpha <- function(x) {r <- 0.55*exp(-x^2) + 0.15 + 0.5/(1+exp(-2*x)); return(r)};   #varying exponent, alpha(-inf) = 0, alpha(+inf) = 1
Psi <- function(x,t) {r <- (t^(-alpha(x))  )/gamma(1-alpha(x)); r[r>1] <- 1; return(r)};           #Tail function of psi measure
a <- function(x,s) {r <- (1)^(-alpha(x)); return(r)};          #a(x,s) diffusivity
b <- function(x,s) {r <- 0; return(r)};                         #b(x,s) drift function
d <- function(x,s) {r <- 0; return(r)};                         #d(x,s) temporal drift function
k025 <- DTSM(xrange, T = 250, Psi, a, b, d);
k050 <- DTSM(xrange, T = 500, Psi, a, b, d);
k075 <- DTSM(xrange, T = 750, Psi, a, b, d);
par(mfrow=c(1,1));
plot(k1$x, k1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
lines(k025$x, k025$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="pink");
lines(k075$x, k075$Px, type="l", col="blue");
#legend
#inset
grid();
k010 <- DTSM(xrange, T = 100, Psi, a, b, d);
par(mfrow=c(1,1));
plot(p1$x, p1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(p2$x, p2$Px, type="l", col="blue");
lines(p5$x, p5$Px, type="l", col="pink");
lines(p10$x, p10$Px, type="l", col="yellow");
lines(p15$x, p15$Px, type="l", col="green");
lines(p25$x, p25$Px, type="l", col="red");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(k1$x, k1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
lines(k010$x, k010$Px, type="l", col="blue");
lines(k025$x, k025$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="pink");
lines(k075$x, k075$Px, type="l", col="blue");
#legend
#inset
grid();
k0025 <- DTSM(xrange, T = 25, Psi, a, b, d);
k0050 <- DTSM(xrange, T = 50, Psi, a, b, d);
k0075 <- DTSM(xrange, T = 75, Psi, a, b, d);
par(mfrow=c(1,1));
plot(k1$x, k1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
lines(k010$x, k010$Px, type="l", col="blue");
lines(k025$x, k025$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="pink");
lines(k075$x, k075$Px, type="l", col="blue");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(k1$x, k1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
lines(k010$x, k010$Px, type="l", col="blue");
lines(k025$x, k025$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="pink");
lines(k075$x, k075$Px, type="l", col="blue");
lines(k0025$x, k0025$Px, type="l", col="blue");
lines(k0050$x, k0050$Px, type="l", col="blue");
lines(k0075$x, k0075$Px, type="l", col="blue");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(k1$x, k1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k0025$x, k0025$Px, type="l", col="blue");
lines(k0050$x, k0050$Px, type="l", col="blue");
lines(k0075$x, k0075$Px, type="l", col="blue");
par(mfrow=c(1,1));
plot(k50$x, k50$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
par(mfrow=c(1,1));
plot(k50$x, k50$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k2$x, k2$Px, type="l", col="blue");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
lines(k0075$x, k0075$Px, type="l", col="blue");
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k010$x, k010$Px, type="l", col="blue");
lines(k025$x, k025$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="pink");
lines(k075$x, k075$Px, type="l", col="blue");
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k010$x, k010$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="pink");
lines(k2$x, k2$Px, type="l", col="blue");
lines(k25$x, k25$Px, type="l", col="red");
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k010$x, k010$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="pink");
lines(k1$x, k1$Px, type="l", col="blue");
lines(k15$x, k15$Px, type="l", col="green");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k5$x, k5$Px, type="l", col="pink");
lines(k25$x, k25$Px, type="l", col="red");
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k5$x, k5$Px, type="l", col="pink");
lines(k10$x, k10$Px, type="l", col="yellow");
lines(k15$x, k15$Px, type="l", col="green");
lines(k25$x, k25$Px, type="l", col="red");
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,4));
lines(k010$x, k010$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="pink");
lines(k1$x, k1$Px, type="l", col="blue");
lines(k10$x, k10$Px, type="l", col="yellow");
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,3.5));
lines(k010$x, k010$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="pink");
lines(k1$x, k1$Px, type="l", col="blue");
lines(k10$x, k10$Px, type="l", col="yellow");
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,3.5));
lines(k010$x, k010$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="green");
lines(k1$x, k1$Px, type="l", col="yellow");
lines(k10$x, k10$Px, type="l", col="red");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(n1$x, n1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(n2$x, n2$Px, type="l", col="blue");
lines(n5$x, n5$Px, type="l", col="pink");
lines(n10$x, n10$Px, type="l", col="yellow");
lines(n15$x, n15$Px, type="l", col="green");
lines(n25$x, n25$Px, type="l", col="red");
lines(n100$x, n100$Px, type="l", col="brown");
#legend
#inset
grid();
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
#legend
#inset
grid();
#Plot densities
par(mfrow=c(1,1));
plot(n1$x, n1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(n2$x, n2$Px, type="l", col="blue");
lines(n5$x, n5$Px, type="l", col="pink");
lines(n10$x, n10$Px, type="l", col="yellow");
lines(n15$x, n15$Px, type="l", col="green");
lines(n25$x, n25$Px, type="l", col="red");
lines(n100$x, n100$Px, type="l", col="brown");
#legend
#inset
grid();
#plot densities
par(mfrow=c(1,1));
plot(p1$x, p1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(p2$x, p2$Px, type="l", col="blue");
lines(p5$x, p5$Px, type="l", col="pink");
lines(p10$x, p10$Px, type="l", col="yellow");
lines(p15$x, p15$Px, type="l", col="green");
lines(p25$x, p25$Px, type="l", col="red");
#legend
#inset
grid();
#legend
legend("topleft",c(expression(10^3) ), title = "Densities at t =" )
#legend
legend("topleft",c(expression(10^3),expression(2 %*% 10^3),expression(10^3),expression(10^3),expression(10^3),expression(10^3) ), title = "Densities at t =" )
#legend
legend("topleft",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3) ), title = "Densities at t =" )
#legend
legend("topleft",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3) ), title = "Densities at t =", lty = c(1,1,1,1,1,1), col=c("black","blue","brown","yellow"."green","red") )
#legend
legend("topleft",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3) ), title = "Densities at t =", lty = c(1,1,1,1,1,1), col=c("black","blue","brown","yellow","green","red") )
#Plot densities
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,3.5));
lines(k010$x, k010$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="green");
lines(k1$x, k1$Px, type="l", col="yellow");
lines(k10$x, k10$Px, type="l", col="red");
legend("topleft",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3) ), title = "Densities at t =", lty = c(1,1,1,1,1,1), col=c("black","blue","brown","yellow","green","red") )
#inset
grid();
legend("topleft",c(expression(50),expression(10^2),expression(5 %*% 10^2),expression(10^3),expression(10^4) ), title = "Densities at t =", lty = c(1,1,1,1,1), col=c("black","blue","green","yellow","red") )
#Plot densities
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,3.5));
lines(k010$x, k010$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="green");
lines(k1$x, k1$Px, type="l", col="yellow");
lines(k10$x, k10$Px, type="l", col="red");
legend("topleft",c(expression(50),expression(10^2),expression(5 %*% 10^2),expression(10^3),expression(10^4) ), title = "Densities at t =", lty = c(1,1,1,1,1), col=c("black","blue","green","yellow","red") )
#inset
grid();
legend("topright",c(expression(50),expression(10^2),expression(5 %*% 10^2),expression(10^3),expression(10^4) ), title = "Densities at t =", lty = c(1,1,1,1,1), col=c("black","blue","green","yellow","red") )
#Plot densities
par(mfrow=c(1,1));
plot(k0050$x, k0050$Px, type="l", xlab = "x", ylab = paste("P(x,t)"), ylim=c(0,3.5));
lines(k010$x, k010$Px, type="l", col="blue");
lines(k050$x, k050$Px, type="l", col="green");
lines(k1$x, k1$Px, type="l", col="yellow");
lines(k10$x, k10$Px, type="l", col="red");
legend("topright",c(expression(50),expression(10^2),expression(5 %*% 10^2),expression(10^3),expression(10^4) ), title = "Densities at t =", lty = c(1,1,1,1,1), col=c("black","blue","green","yellow","red") )
#inset
grid();
#Plot densities
par(mfrow=c(1,1));
plot(n1$x, n1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(n2$x, n2$Px, type="l", col="blue");
lines(n5$x, n5$Px, type="l", col="pink");
lines(n10$x, n10$Px, type="l", col="yellow");
lines(n15$x, n15$Px, type="l", col="green");
lines(n25$x, n25$Px, type="l", col="red");
lines(n100$x, n100$Px, type="l", col="brown");
legend("topleft",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3) ), title = "Densities at t =", lty = c(1,1,1,1,1,1), col=c("black","blue","brown","yellow","green","red") )
#inset
grid();
legend("topleft",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3), expression(10^5) ), title = "Densities at t =", lty = c(1,1,1,1,1,1,1), col=c("black","blue","pink","yellow","green","red","brown") )
#Plot densities
par(mfrow=c(1,1));
plot(n1$x, n1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(n2$x, n2$Px, type="l", col="blue");
lines(n5$x, n5$Px, type="l", col="pink");
lines(n10$x, n10$Px, type="l", col="yellow");
lines(n15$x, n15$Px, type="l", col="green");
lines(n25$x, n25$Px, type="l", col="red");
lines(n100$x, n100$Px, type="l", col="brown");
legend("topleft",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3), expression(10^5) ), title = "Densities at t =", lty = c(1,1,1,1,1,1,1), col=c("black","blue","pink","yellow","green","red","brown") )
#inset
grid();
#Plot densities
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
legend("topleft",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3) ), title = "Densities at t =", lty = c(1,1,1,1,1,1), col=c("black","blue","brown","yellow","green","red") )
#inset
grid();
legend("topright",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3) ), title = "Densities at t =", lty = c(1,1,1,1,1,1), col=c("black","blue","brown","yellow","green","red") )
#Plot densities
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
legend("topright",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3) ), title = "Densities at t =", lty = c(1,1,1,1,1,1), col=c("black","blue","brown","yellow","green","red") )
#inset
grid();
#Plot densities
par(mfrow=c(1,1));
plot(m1$x, m1$Px, type="l", xlab = "x", ylab = paste("P(x,t)"));
lines(m2$x, m2$Px, type="l", col="blue");
lines(m5$x, m5$Px, type="l", col="pink");
lines(m10$x, m10$Px, type="l", col="yellow");
lines(m15$x, m15$Px, type="l", col="green");
lines(m25$x, m25$Px, type="l", col="red");
legend("topright",c(expression(10^3),expression(2 %*% 10^3),expression(5 %*% 10^3),expression(10 %*% 10^3),expression(15 %*% 10^3),expression(25 %*% 10^3) ), title = "Densities at t =", lty = c(1,1,1,1,1,1), col=c("black","blue","pink","yellow","green","red") )
#inset
grid();
save.image("D:/p0010 varyExp nonlinear subdiffusion/varyExp/varyExp.RData")
savehistory("D:/p0010 varyExp nonlinear subdiffusion/varyExp/varyExp.Rhistory")
